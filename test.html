<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <form onsubmit="return false">

        Full Name:
        <input type="text" name="subject" value="" id="name">
        </p>
        Email:
        <input type="text" name="email" value="" id="email">
        <p>
            Message:
            <textarea name="message" id="message"></textarea>
        </p>
        <p>
            Select file:
            <input type="file" accept=".docx" required id="file" name="file">
        </p>

        <button class="button" type="submit">
            Send
        </button>

    </form>

    <script src="https://smtpjs.com/v3/smtp.js"></script>
    <script>


        const button = document.querySelector('.button');

        button.addEventListener('click', sendEmail)

        function uploadFileToServer() {
            var file = document.getElementById('file').files[0];
            var reader = new FileReader();
            reader.readAsBinaryString(file);
            reader.onload = function () {
                var dataUri = "data:" + file.type + ";base64," + btoa(reader.result);
                console.log(dataUri)
                Email.send({
                    Host: "smtp.mailtrap.io",
                    Username: "95bdf05edbf8c8",
                    Password: "4a71fc4b963d4c",
                    To: 'hominhchanh11@gmail.com',
                    From: "you@source.com",
                    Subject: "Send with base64 attachment",
                    Body: "Sending file:" + file.name,
                    Attachments: [
                        {
                            name: file.name,
                            data: dataUri
                        }]
                }).then(
                    message => alert(message)
                );
            };
            reader.onerror = function () {
                console.log('there are some problems');
            };
        }



        function sendEmail() {
            const message = document.getElementById("message").value;
            const mailFrom = document.getElementById('email').value;

            var file = document.getElementById('file').files[0];
            var reader = new FileReader();
            reader.readAsBinaryString(file);
            reader.onload = function () {
                var dataUri = "data:" + file.type + ";base64," + btoa(reader.result);
                Email.send({
                    Host: "smtp.mailtrap.io",
                    Username: "95bdf05edbf8c8",
                    Password: "4a71fc4b963d4c",
                    To: 'hominhchanh11@gmail.com',
                    From: mailFrom,
                    Subject: "Email Submission",
                    Body: message,
                    Attachments: [
                        {
                            name: file.name,
                            data: dataUri
                        }]
                }).then(
                    message => alert(message)
                );
            }
        }

    </script>
</body>

</html>